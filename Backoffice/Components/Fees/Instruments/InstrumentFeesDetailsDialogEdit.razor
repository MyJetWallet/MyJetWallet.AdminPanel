@using Service.Fees.Domain.Models
<BaseTwoButtonsDialog
    Caption=@(!IsCreate ? $"{Item.SpotInstrumentId} [{Item.BrokerId}]" : "Create a new Asset fees")
    OnClose="OnClose"
    YesButtonCaption="@(IsCreate ? "Create" : "Save")"
    NoButtonCaption="Close"
    OnSubmit="OnSubmit">
    <EditForm Model="@this">
        <table>

            <tr>
                <td>

                    <table>
                        <tr>
                            <td>Broker</td>
                            <td class="float-left">
                                @if (!IsCreate)
                                {
                                    @Item.BrokerId
                                }
                                else
                                {
                                    <input type="text" class="form-control" @bind="Item.BrokerId"/>
                                }
                            </td>
                        </tr>
                        <tr>
                            <td>Instrument</td>
                            <td class="float-left">
                                @if (!IsCreate)
                                {
                                    @Item.SpotInstrumentId
                                }
                                else
                                {
                                    <input type="text" class="form-control" @bind="Item.SpotInstrumentId"/>
                                }
                            </td>
                        </tr>
                        <tr></tr>
                        <tr>
                            <td>Fee Type</td>
                            <td class="float-left">
                                <InputSelect @bind-Value="@Item.FeeType">
                                    <option value="@FeeType.NoFee">
                                        <MyLabel Text="@(FeeType.NoFee.ToString())"/>
                                    </option>
                                    <option value="@FeeType.ClientFee">
                                        <MyLabel Text="@(FeeType.ClientFee.ToString())"/>
                                    </option>
                                    <option value="@FeeType.ExternalFee">
                                        <MyLabel Text="@(FeeType.ExternalFee.ToString())"/>
                                    </option>
                                </InputSelect>
                            </td>
                        </tr>
                        <tr>
                            <td>Fee account id</td>
                            <td class="float-left">
                                <input type="text" class="form-control" @bind="Item.AccountId"/>
                            </td>
                        </tr>
                        <tr>
                            <td>Fee wallet id</td>
                            <td class="float-left">
                                <input type="text" class="form-control" @bind="Item.WalletId"/>
                            </td>
                        </tr>
                        <tr>
                            <td>Fee asset id</td>
                            <td class="float-left">
                                <input type="text" class="form-control" @bind="Item.FeeAssetId"/>
                            </td>
                        </tr>
                        <tr>
                            <td>Maker Fee size</td>
                            <td class="float-left">
                                <input type="number" class="form-control" @bind="Item.MakerFeeSize"/>
                            </td>
                        </tr>
                        <tr>
                            <td>Maker Fee size type</td>
                            <td class="float-left">
                                <InputSelect @bind-Value="@Item.MakerFeeSizeType">
                                    <option value="@FeeSizeType.Absolute">
                                        <MyLabel Text="@(FeeSizeType.Absolute.ToString())"/>
                                    </option>
                                    <option value="@FeeSizeType.Percentage">
                                        <MyLabel Text="@(FeeSizeType.Percentage.ToString())"/>
                                    </option>
                                </InputSelect>
                            </td>
                        </tr>
                        <tr>
                            <td>Taker Fee size</td>
                            <td class="float-left">
                                <input type="number" class="form-control" @bind="Item.TakerFeeSize"/>
                            </td>
                        </tr>
                        <tr>
                            <td>Taker Fee size type</td>
                            <td class="float-left">
                                <InputSelect @bind-Value="@Item.TakerFeeSizeType">
                                    <option value="@FeeSizeType.Absolute">
                                        <MyLabel Text="@(FeeSizeType.Absolute.ToString())"/>
                                    </option>
                                    <option value="@FeeSizeType.Percentage">
                                        <MyLabel Text="@(FeeSizeType.Percentage.ToString())"/>
                                    </option>
                                </InputSelect>
                            </td>
                        </tr>
                    </table>
                </td>

            </tr>
        </table>
    </EditForm>
</BaseTwoButtonsDialog>

@code {

    [Parameter]
    public SpotInstrumentFees Item { get; set; }

    [Parameter]
    public bool IsCreate { get; set; }

    [Parameter]
    public EventCallback OnCloseCallback { get; set; }

    [Parameter]
    public EventCallback<SpotInstrumentFees> OnCreateCallback { get; set; }

    [Parameter]
    public EventCallback<SpotInstrumentFees> OnUpdateCallback { get; set; }

    private void OnClose()
    {
        OnCloseCallback.InvokeAsync();
    }

    private async Task OnSubmit()
    {
        if (IsCreate)
            await OnCreateCallback.InvokeAsync(Item);
        else
            await OnUpdateCallback.InvokeAsync(Item);
    }

    protected override void OnInitialized()
    {
        base.OnInitialized();
        if (IsCreate)
            Item = new SpotInstrumentFees()
            {
                BrokerId = "jetwallet",
                FeeType = FeeType.NoFee,
                MakerFeeSizeType = FeeSizeType.Absolute,
                TakerFeeSizeType = FeeSizeType.Absolute,
            };
    }

}